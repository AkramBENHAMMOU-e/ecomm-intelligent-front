<div class="checkout">
  <div class="checkout-header">
    <h2>Passer la commande</h2>
    <p>Finalisez votre commande en quelques √©tapes simples</p>
  </div>

  <div class="checkout-grid">
    <!-- Formulaire client -->
    <section class="customer-section">
      <div class="section-header">
        <h3>Informations de livraison</h3>
        <p>Renseignez vos coordonn√©es</p>
      </div>
      
      <div class="form-grid">
        <div class="form-group">
          <label for="firstName" class="form-label">Pr√©nom</label>
          <input id="firstName" type="text" class="form-input" [(ngModel)]="firstName" placeholder="Votre pr√©nom" required />
        </div>
        
        <div class="form-group">
          <label for="lastName" class="form-label">Nom</label>
          <input id="lastName" type="text" class="form-input" [(ngModel)]="lastName" placeholder="Votre nom" required />
        </div>
        
        <div class="form-group">
          <label for="email" class="form-label">Email</label>
          <input id="email" type="email" class="form-input" [(ngModel)]="email" placeholder="votre@email.com" required />
        </div>
        
        <div class="form-group">
          <label for="phone" class="form-label">T√©l√©phone</label>
          <input id="phone" type="tel" class="form-input" [(ngModel)]="phoneNumber" placeholder="0123456789" required />
        </div>
        
        <div class="form-group full-width">
          <label for="address" class="form-label">Adresse de livraison</label>
          <textarea id="address" rows="3" class="form-input" [(ngModel)]="address" placeholder="Votre adresse compl√®te" required></textarea>
        </div>
      </div>

      <div class="action-buttons">
        <button (click)="placeOrder()" [disabled]="loading || !cart?.items?.length" class="btn-primary btn-lg">
          <span *ngIf="loading" class="btn-loading"></span>
          {{ loading ? 'Traitement en cours...' : 'Valider la commande' }}
        </button>
      </div>
      
      <div class="form-error" *ngIf="error">
        {{ error }}
      </div>
    </section>

    <!-- R√©sum√© de la commande -->
    <section class="order-summary-side">
      <div class="summary-header">
        <h3>R√©sum√©</h3>
      </div>

      <div class="cart-items-list">
        <div *ngFor="let item of cart?.items" class="cart-item">
          <div class="item-image">
            <img [src]="item.product.image" [alt]="item.product.name" />
          </div>
          <div class="item-details">
            <div class="item-name">{{ item.product.name }}</div>
            <div class="item-quantity">Quantit√©: {{ item.quantity }}</div>
            <div class="item-price">{{ (item.product.price * item.quantity) | currency:'DH':'symbol':'1.2-2' }}</div>
          </div>
        </div>
      </div>

      <div class="order-total">
        <div class="total-line">
          <span class="total-label">Total</span>
          <span class="total-amount">{{ totalPrice | currency:'DH':'symbol':'1.2-2' }}</span>
        </div>
      </div>
    </section>
  </div>

  <!-- Email Confirmation Modal -->
  <div class="modal-overlay" *ngIf="showEmailConfirm" (click)="cancelOrder()">
    <div class="modal-container" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>Confirmation de commande</h3>
        <button class="modal-close" (click)="cancelOrder()">‚úï</button>
      </div>
      <div class="modal-body">
        <p>Un email de confirmation sera envoy√© √†:</p>
        <p class="email-highlight">{{ email }}</p>
        <p>Confirmez-vous cette commande?</p>
      </div>
      <div class="modal-footer">
        <button class="btn-secondary" (click)="cancelOrder()">Annuler</button>
        <button class="btn-primary" (click)="confirmOrder()">Confirmer la commande</button>
      </div>
    </div>
  </div>

  <div class="order-summary" *ngIf="order">
    <div class="summary-header">
      <h3>üéâ Commande cr√©√©e avec succ√®s !</h3>
      <div class="order-badge">
        <span class="order-id">#{{ order.id }}</span>
        <span class="order-date">{{ order.date }}</span>
        <span class="order-status">{{ order.status }}</span>
      </div>
    </div>
    
    <div class="customer-info-card" *ngIf="order.customer">
      <h4>üë§ Informations du client</h4>
      <div class="info-grid">
        <div class="info-item">
          <span class="info-label">Nom complet</span>
          <span class="info-value">{{ order.customer.firstName }} {{ order.customer.lastName }}</span>
        </div>
        <div class="info-item" *ngIf="order.customer.email">
          <span class="info-label">Email</span>
          <span class="info-value">{{ order.customer.email }}</span>
        </div>
        <div class="info-item" *ngIf="order.customer.phone">
          <span class="info-label">T√©l√©phone</span>
          <span class="info-value">{{ order.customer.phone }}</span>
        </div>
        <div class="info-item" *ngIf="order.customer.address">
          <span class="info-label">Adresse</span>
          <span class="info-value">{{ order.customer.address }}</span>
        </div>
      </div>
    </div>

    <div class="items-table-container">
      <h4>üì¶ Articles command√©s</h4>
      <table class="items-table">
        <thead>
          <tr>
            <th>Produit</th>
            <th>Prix unitaire</th>
            <th>Quantit√©</th>
            <th>Sous-total</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let it of order.items">
            <td class="product-name">{{ it.product.name }}</td>
            <td class="price">{{ it.price | currency:'DH':'symbol':'1.2-2' }}</td>
            <td class="quantity">{{ it.quantity }}</td>
            <td class="subtotal">{{ (it.price * it.quantity) | currency:'DH':'symbol':'1.2-2' }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="total-row">
            <td colspan="3" class="total-label">üí∞ Total de la commande</td>
            <td class="total-amount">{{ totalAmount | currency:'DH':'symbol':'1.2-2' }}</td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>
</div>
